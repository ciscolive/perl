.\" Automatically generated by Pod::Man 4.14 (Pod::Simple 3.40)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "Workflow::History 3"
.TH Workflow::History 3 "2020-07-11" "perl v5.32.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
Workflow::History \- Recorded work on a workflow action or workflow itself
.SH "VERSION"
.IX Header "VERSION"
This documentation describes version 1.10 of this package
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 9
\& # in your action
\& sub execute {
\&     my ( $self, $wf ) = @_;
\&     my $current_user = $wf\->context\->param( \*(Aqcurrent_user\*(Aq );
\&     # ... do your work with $ticket
\&     $wf\->add_history( action => \*(Aqcreate ticket\*(Aq,
\&                       user   => $current_user\->full_name,
\&                       description => "Ticket $ticket\->{subject} successfully created" );
\& }
\&
\& # in your view (using TT2)
\& [% FOREACH history = workflow.get_history %]
\&    On:     [% OI.format_date( history.date, \*(Aq%Y\-%m\-%d %H:%M\*(Aq ) %]<br>
\&    Action: [% history.action %] (ID: [% history.id %])<br>
\&    by:     [% history.user %]<br>
\&    [% history.description %]
\& [% END %]
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Every workflow can record its history. More appropriately, every
action the workflow executes can deposit history entries in the
workflow to be saved later. Neither the action nor the workflow knows
about how the history is saved, just that the history is available.
.SH "METHODS"
.IX Header "METHODS"
.SS "Public Methods"
.IX Subsection "Public Methods"
\fInew( \e%params )\fR
.IX Subsection "new( %params )"
.PP
Create a new history object, filling it with properties from
\&\f(CW\*(C`\e%params\*(C'\fR.
.PP
\fIset_new_state( \f(CI$new_state\fI )\fR
.IX Subsection "set_new_state( $new_state )"
.PP
Assigns the new state \f(CW$new_state\fR to the history if the state is not
already assigned. This is used when you generate a history request in
a Workflow::Action since the workflow state will change once the
action has successfully completed. So in the action you create a
history object without the state:
.PP
.Vb 7
\&  $wf\->add_history(
\&      Workflow::History\->new({
\&          action      => "Cocoa Puffs",
\&          description => "They\*(Aqre magically delicious",
\&          user        => "Count Chocula",
\&      })
\&  );
.Ve
.PP
And then after the new state has been set but before the history
objects are stored the workflow sets the new state in all unsaved
history objects.
.PP
\fI\f(BIis_saved()\fI\fR
.IX Subsection "is_saved()"
.PP
Returns true (1) if this history object has been saved, false (0) if not.
.SS "Properties"
.IX Subsection "Properties"
.IP "\(bu" 4
\&\fBid\fR \- \s-1ID\s0 of history entry
.IP "\(bu" 4
\&\fBworkflow_id\fR \- \s-1ID\s0 of workflow to which history is attached
.IP "\(bu" 4
\&\fBaction\fR \- Brief description of action taken
.IP "\(bu" 4
\&\fBdescription\fR \- Lengthy description of action taken
.IP "\(bu" 4
\&\fBdate\fR \- Date history noted, set to a DateTime object.
.IP "\(bu" 4
\&\fBtime_zone\fR \- Time zone to pass to the DateTime object.
.IP "\(bu" 4
\&\fBuser\fR \- User name (\s-1ID,\s0 login, or full name, up to you) taking action
(may be blank)
.IP "\(bu" 4
\&\fBstate\fR \- State of workflow as history was recorded.
.PP
\fIclear_saved\fR
.IX Subsection "clear_saved"
.PP
Sets saved state to false and returns 0
.PP
\fIset_saved\fR
.IX Subsection "set_saved"
.PP
Sets saved state to true and returns 1
.SH "SEE ALSO"
.IX Header "SEE ALSO"
Workflow
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (c) 2003\-2007 Chris Winters. All rights reserved.
.PP
This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.
.SH "AUTHORS"
.IX Header "AUTHORS"
Jonas B. Nielsen (jonasbn) <jonasbn@cpan.org> is the current maintainer.
.PP
Chris Winters <chris@cwinters.com>
