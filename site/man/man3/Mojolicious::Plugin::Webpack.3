.\" Automatically generated by Pod::Man 4.14 (Pod::Simple 3.40)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "Mojolicious::Plugin::Webpack 3"
.TH Mojolicious::Plugin::Webpack 3 "2020-09-07" "perl v5.32.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
Mojolicious::Plugin::Webpack \- Mojolicious â™¥ Webpack
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
Check out
<https://github.com/jhthorsen/mojolicious\-plugin\-webpack/tree/master/example/webpack>
for a working example.
.SS "Define assets"
.IX Subsection "Define assets"
One or more assets need to be defined. The minimum is to create one
entry point <https://webpack.js.org/concepts/#entry> and add it to
the \f(CW\*(C`webpack.custom.js\*(C'\fR file.
.PP
.Vb 4
\&  # Entrypoint: ./assets/entry\-cool_beans.js
\&  // This will result in one css and one js asset.
\&  import \*(Aq../css/css\-example.css\*(Aq;
\&  console.log(\*(AqI\*(Aqm loaded!\*(Aq);
\&
\&  # Config file: ./assets/webpack.custom.js
\&  module.exports = function(config) {
\&    config.entry = {
\&      \*(Aqcool_beans\*(Aq: \*(Aq./assets/entry\-cool_beans.js\*(Aq,
\&    };
\&  };
.Ve
.SS "Application"
.IX Subsection "Application"
Your lite or full app, need to load Mojolicious::Plugin::Webpack and
tell it what kind of assets it should be able to process:
.PP
.Vb 1
\&  $app\->plugin(Webpack => {process => [qw(js css)]});
.Ve
.PP
See \*(L"register\*(R" for more config options.
.SS "Template"
.IX Subsection "Template"
To include the generated assets in your template, you can use the \*(L"asset\*(R"
helper:
.PP
.Vb 2
\&  %= asset "cool_beans.css"
\&  %= asset "cool_beans.js"
.Ve
.SS "Start application"
.IX Subsection "Start application"
You can start the application using \f(CW\*(C`daemon\*(C'\fR, \f(CW\*(C`hypnotoad\*(C'\fR or any Mojolicious
server you want, but if you want rapid development you should use
\&\f(CW\*(C`mojo webpack\*(C'\fR, which is an alternative to \f(CW\*(C`morbo\*(C'\fR:
.PP
.Vb 2
\&  $ mojo webpack \-h
\&  $ mojo webpack ./myapp.pl
.Ve
.PP
However if you want to use another daemon and force \f(CW\*(C`webpack\*(C'\fR to run, you need
to set the \f(CW\*(C`MOJO_WEBPACK_BUILD\*(C'\fR environment variable to \*(L"1\*(R". Example:
.PP
.Vb 1
\&  MOJO_WEBPACK_BUILD=1 ./myapp.pl daemon
.Ve
.SS "Testing"
.IX Subsection "Testing"
If you want to make sure you have built all the assets, you can make a test
file like \*(L"build\-assets.t\*(R":
.PP
.Vb 2
\&  use Test::More;
\&  use Test::Mojo;
\&
\&  # Run with TEST_BUILD_ASSETS=1 prove \-vl t/build\-assets.t
\&  plan skip_all => "TEST_BUILD_ASSETS=1" unless $ENV{TEST_BUILD_ASSETS};
\&
\&  # Load the app and make a test object
\&  $ENV{MOJO_MODE}          = \*(Aqproduction\*(Aq;
\&  $ENV{MOJO_WEBPACK_BUILD} = 1;
\&  use FindBin;
\&  require "$FindBin::Bin/../myapp.pl";
\&  my $t = Test::Mojo\->new;
\&
\&  # Find all the tags and make sure they can be loaded
\&  $t\->get_ok("/")\->status_is(200);
\&  $t\->element_count_is(\*(Aqscript[src], link[href][rel=stylesheet]\*(Aq, 2);
\&  $t\->tx\->res\->dom\->find("script[src], link[href][rel=stylesheet]")\->each(sub {
\&    $t\->get_ok($_\->{href} || $_\->{src})\->status_is(200);
\&  });
\&
\&  done_testing;
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Mojolicious::Plugin::Webpack is a Mojolicious plugin to make it easier to
work with <https://webpack.js.org/>. This plugin will...
.IP "1." 2
Generate a minimal \f(CW\*(C`package.json\*(C'\fR and a Webpack config file. Doing this
manually is possible, but it can be quite time consuming to figure out all the
bits and pieces if you are not already familiar with Webpack.
.Sp
.Vb 2
\&  ./package.json
\&  ./webpack.config.js
.Ve
.IP "2." 2
Generate a \f(CW\*(C`webpack.custom.js\*(C'\fR which is meant to be the end user config file
where you can override any part of the default config. You are free to modify
\&\f(CW\*(C`webpack.config.js\*(C'\fR directly, but doing so will prevent
Mojolicious::Plugin::Webpack from patching it in the future.
.Sp
The default \f(CW\*(C`webpack.custom.js\*(C'\fR file will simply define an \*(L"entry\*(R" which is
the starting point of your application.
.Sp
.Vb 1
\&  ./assets/webpack.custom.js
.Ve
.IP "3." 2
Generate an entry file, which is the starting point of your client side
application. The entry file can load JavaScript, \s-1CSS, SASS, ...\s0 as long as the
appropriate processing plugin is loaded by Webpack.
.Sp
.Vb 1
\&  ./assets/my_app.js
.Ve
.IP "4." 2
It can be difficult to know exactly which plugins to use with Webpack. Because
of this, Mojolicious::Plugin::Webpack has some predefined rules for which
Nodejs dependencies to fetch and  install. None of the nodejs modules are
required in production though, so it will only be installed while developing.
.IP "5." 2
While developing, the webpack executable will be started automatically next to
Mojo::Server::Morbo. Webpack will be started with the appropriate switches
to watch your source files and re-compile on change.
.PP
There is also support for <https://rollupjs.org/>. See \*(L"Rollup\*(R" for more
information.
.PP
Mojolicious::Plugin::Webpack is currently \s-1EXPERIMENTAL,\s0 but it's unlikely it
will change dramatically.
.PP
After creating the file, you can run the command below to get a development
server:
.PP
.Vb 1
\&  $ perl myapp.pl webpack \-c rollup.config.js
.Ve
.PP
If you want to do \*(L"Testing\*(R", you have to set the environment variable
\&\f(CW\*(C`MOJO_WEBPACK_CONFIG\*(C'\fR in addition to \s-1TEST_BUILD_ASSETS\s0:
.PP
.Vb 1
\&  $ENV{MOJO_WEBPACK_CONFIG} = \*(Aqrollup.config.js\*(Aq;
.Ve
.SS "Rollup"
.IX Subsection "Rollup"
rollup.js <https://rollupjs.org/> is an alternative to Webpack. Both
accomplish more or less the same thing, but in different ways. There might be a
\&\*(L"Rollup\*(R" plugin in the future, but for now this plugin supports both.
.PP
For now, you need to write your own \*(L"rollup.config.js\*(R" file. See
<https://github.com/jhthorsen/mojolicious\-plugin\-webpack/tree/master/example/rollup>
for a working example.
.SH "MIGRATING FROM ASSETPACK"
.IX Header "MIGRATING FROM ASSETPACK"
Are you already a user of Mojolicious::Plugin::AssetPack?
Mojolicious::Plugin::Webpack will automatically detect your \f(CW\*(C`assetpack.def\*(C'\fR
file and convert it into a custom webpack config, so you don't have to do
much, except changing how you load the plugin:
.PP
.Vb 2
\&  # AssetPack
\&  $app\->plugin(AssetPack => {pipes => [qw(Sass JavaScript)]});
\&
\&  # Webpack
\&  $app\->plugin(Webpack => {process => [qw(sass js)]});
.Ve
.SH "HELPERS"
.IX Header "HELPERS"
.SS "asset"
.IX Subsection "asset"
.Vb 2
\&  # Call a method or access an attribute in this class
\&  my $path = $app\->asset\->out_dir;
\&
\&  # Call a method, but from inside a mojo template
\&  %= asset\->url_for($c, "cool_beans.css")
\&
\&  # Generate a HTML tag
\&  my $bytestream = $c\->asset("cool_beans.js", @args);
\&
\&  # Generate a HTML tag, but from inside a mojo template
\&  %= asset "cool_beans.css", media => "print"
\&  %= asset(url_for => "cool_beans.css")
.Ve
.PP
This helper will return the plugin instance if no arguments is passed in, or a
\&\s-1HTML\s0 tag created with either \*(L"javascript\*(R" in Mojolicious::Plugin::TagHelpers or
\&\*(L"stylesheet\*(R" in Mojolicious::Plugin::TagHelpers if a valid asset name is passed
in.
.PP
You can also use it to call a method and pass on \f(CW$c\fR by passing in a method
name as the first argument, such as \*(L"url_for\*(R".
.SH "ATTRIBUTES"
.IX Header "ATTRIBUTES"
.SS "assets_dir"
.IX Subsection "assets_dir"
.Vb 1
\&  $path = $self\->assets_dir;
.Ve
.PP
Holds a Mojo::File object pointing to the private directoy where source
files are read from. Defaults value is:
.PP
.Vb 1
\&  $app\->home\->rel_file("assets");
.Ve
.SS "node_env"
.IX Subsection "node_env"
.Vb 1
\&  $str = $self\->node_env;
.Ve
.PP
Used to set \f(CW\*(C`NODE_ENV\*(C'\fR environment value.
.PP
Defaults value is \*(L"development\*(R" if \*(L"mode\*(R" in Mojolicious is \*(L"development\*(R" and
\&\*(L"production\*(R" otherwise. This value usually tells webpack to either minify the
assets or generate readable output while developing.
.SS "out_dir"
.IX Subsection "out_dir"
.Vb 1
\&  $path = $self\->out_dir;
.Ve
.PP
Holds a Mojo::File object pointing to the public directoy where processed
assets are written to. Default value is:
.PP
.Vb 1
\&  $app\->static\->paths\->[0] . "/asset";
.Ve
.SS "route"
.IX Subsection "route"
.Vb 1
\&  $route = $self\->route;
.Ve
.PP
Holds a Mojolicious::Routes::Route object that generates the URLs to a
processed asset. Default value is \f(CW\*(C`/asset/*name\*(C'\fR.
.SH "METHODS"
.IX Header "METHODS"
.SS "register"
.IX Subsection "register"
.Vb 2
\&  $self\->register($app, \e%config);
\&  $app\->plugin("Webpack", \e%config);
.Ve
.PP
Used to register this plugin into your Mojolicious app.
.PP
The \f(CW%config\fR passed when loading this plugin can have any of the
\&\*(L"\s-1ATTRIBUTES\*(R"\s0 in Mojolicious::Plugin::Webpack::Builder, in addition to these
attributes:
.IP "\(bu" 2
helper
.Sp
Name of the helper that will be added to your application.
.Sp
Default: \*(L"asset\*(R".
.SS "url_for"
.IX Subsection "url_for"
.Vb 1
\&  $url = $self\->url_for($c, $asset_name);
.Ve
.PP
Returns a Mojo::URL for a given asset.
.SH "AUTHOR"
.IX Header "AUTHOR"
Jan Henning Thorsen
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
Copyright (C) 2018, Jan Henning Thorsen
.PP
This program is free software, you can redistribute it and/or modify it under
the terms of the Artistic License version 2.0.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
Mojolicious::Plugin::Webpack::Builder.
.PP
Mojolicious::Plugin::AssetPack.
