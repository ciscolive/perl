.\" Automatically generated by Pod::Man 4.14 (Pod::Simple 3.40)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "WWW::Mechanize::Cached 3"
.TH WWW::Mechanize::Cached 3 "2020-08-10" "perl v5.32.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
WWW::Mechanize::Cached \- Cache response to be polite
.SH "VERSION"
.IX Header "VERSION"
version 1.54
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 1
\&    use WWW::Mechanize::Cached;
\&
\&    my $cacher = WWW::Mechanize::Cached\->new;
\&    $cacher\->get( \*(Aqhttps://metacpan.org\*(Aq );
\&
\&    # or, with your own Cache object
\&    use CHI;
\&    use WWW::Mechanize::Cached;
\&
\&    my $cache = CHI\->new(
\&        driver   => \*(AqFile\*(Aq,
\&        root_dir => \*(Aq/tmp/mech\-example\*(Aq
\&    );
\&
\&    my $mech = WWW::Mechanize::Cached\->new( cache => $cache );
\&    $mech\->get("http://www.wikipedia.org");
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Uses the Cache::Cache hierarchy by default to implement a caching Mech. This
lets one perform repeated requests without hammering a server impolitely.
Please note that Cache::Cache has been superseded by \s-1CHI\s0, but the default
has not been changed here for reasons of backwards compatibility.  For this
reason, you are encouraged to provide your own \s-1CHI\s0 caching object to
override the default.
.SH "CONSTRUCTOR"
.IX Header "CONSTRUCTOR"
.SS "new"
.IX Subsection "new"
Behaves like, and calls, WWW::Mechanize's \f(CW\*(C`new\*(C'\fR method. Any params, other
than those explicitly listed here are passed directly to WWW::Mechanize's
constructor.
.PP
You may pass in a \f(CW\*(C`cache => $cache_object\*(C'\fR if you wish. The
\&\fI\f(CI$cache_object\fI\fR must have \f(CW\*(C`get()\*(C'\fR and \f(CW\*(C`set()\*(C'\fR methods like the
\&\f(CW\*(C`Cache::Cache\*(C'\fR family.
.PP
The default Cache object is set up with the following params:
.PP
.Vb 3
\&    my $cache_params = {
\&        default_expires_in => "1d", namespace => \*(Aqwww\-mechanize\-cached\*(Aq,
\&    };
\&
\&    $cache = Cache::FileCache\->new( $cache_params );
.Ve
.PP
This should be fine if you only want to use a disk-based cache, you only want
to cache results for 1 day and you're not in a shared hosting environment.
If any of this presents a problem for you, you should pass in your own Cache
object.  These defaults will remain unchanged in order to maintain backwards
compatibility.
.PP
For example, you may want to try something like this:
.PP
.Vb 2
\&    use WWW::Mechanize::Cached;
\&    use CHI;
\&
\&    my $cache = CHI\->new(
\&        driver   => \*(AqFile\*(Aq,
\&        root_dir => \*(Aq/tmp/mech\-example\*(Aq
\&    );
\&
\&    my $mech = WWW::Mechanize::Cached\->new( cache => $cache );
\&    $mech\->get("http://www.wikipedia.org");
.Ve
.SH "METHODS"
.IX Header "METHODS"
Most methods are provided by WWW::Mechanize. See that module's
documentation for details.
.ie n .SS "cache( $cache_object )"
.el .SS "cache( \f(CW$cache_object\fP )"
.IX Subsection "cache( $cache_object )"
Requires an caching object which has a \fBget()\fR and a \fBset()\fR method. Using the \s-1CHI\s0
module to create your cache is the recommended way. See \fBnew()\fR for examples.
.SS "\fBis_cached()\fP"
.IX Subsection "is_cached()"
Returns true if the current page is from the cache, or false if not. If it
returns \f(CW\*(C`undef\*(C'\fR, then you don't have any current request.
.SS "positive_cache( 0|1 )"
.IX Subsection "positive_cache( 0|1 )"
As of v1.36 positive caching is enabled by default. Up to this point,
this module had employed a negative cache, which means it cached 404
responses, temporary redirects etc. In most cases, this is not what you want,
so the default behaviour now better reflects this. You can revert to the
negative cache quite easily:
.PP
.Vb 2
\&    # cache everything (404s, all 300s etc)
\&    $mech\->positive_cache( 0 );
.Ve
.SS "ref_in_cache_key( 0|1 )"
.IX Subsection "ref_in_cache_key( 0|1 )"
Allow the referring \s-1URL\s0 to be used when creating the cache key.  This is off
by default.  In almost all cases, you will not want to enable this, but it is
available to you for reasons of backwards compatibility and giving you enough
rope to hang yourself.
.PP
Previous to v1.36 the following was in the \*(L"\s-1BUGS AND LIMITATIONS\*(R"\s0 section:
.PP
.Vb 5
\&    It may sometimes seem as if it\*(Aqs not caching something. And this may well
\&    be true. It uses the HTTP request, in string form, as the key to the cache
\&    entries, so any minor changes will result in a different key. This is most
\&    noticable when following links as L<WWW::Mechanize> adds a C<Referer>
\&    header.
.Ve
.PP
See \s-1RT\s0 #56757 for a detailed example of the bugs this functionality can
trigger.
.SS "cache_undef_content_length( 0 | 'warn' | 1 )"
.IX Subsection "cache_undef_content_length( 0 | 'warn' | 1 )"
This is configuration option which adjusts how caching behaviour performs when
the Content-Length header is not specified by the server.
.PP
Default behaviour is 0, which is not to cache.
.PP
Setting this value to 1, will cache pages even if the Content-Length header is
missing, which was the default behaviour prior to the addition of this feature.
.PP
And thirdly, you can set the value to the string 'warn', to warn if this
scenario occurs, and then not cache it.
.SS "cache_zero_content_length( 0 | 'warn' | 1 )"
.IX Subsection "cache_zero_content_length( 0 | 'warn' | 1 )"
This is configuration option which adjusts how caching behaviour performs when
the Content-Length header is equal to 0.
.PP
Default behaviour is 0, which is not to cache.
.PP
Setting this value to 1, will cache pages even if the Content-Length header is
0, which was the default behaviour prior to the addition of this feature.
.PP
And thirdly, you can set the value to the string 'warn', to warn if this
scenario occurs, and then not cache it.
.SS "cache_mismatch_content_length( 0 | 'warn' | 1 )"
.IX Subsection "cache_mismatch_content_length( 0 | 'warn' | 1 )"
This is configuration option which adjusts how caching behaviour performs when
the Content-Length header differs from the length of the content itself. ( Which
usually indicates a transmission error )
.PP
Setting this value to 0, will silently not cache pages with a Content-Length
mismatch.
.PP
Setting this value to 1, will cache pages even if the Content-Length header
conflicts with the content length, which was the default behaviour prior to the
addition of this feature.
.PP
And thirdly, you can set the value to the string 'warn', to warn if this
scenario occurs, and then not cache it. ( This is the default behaviour )
.SS "\fBinvalidate_last_request()\fP"
.IX Subsection "invalidate_last_request()"
Remove the last request from the cache.
.PP
The return value reveals whether the request was successfully removed from the
cache. 1 means it's still cached, 0 means it was removed, and undef means there
was nothing to remove (there was no request or it wasn't cached).
.SH "UPGRADING FROM 1.40 OR EARLIER"
.IX Header "UPGRADING FROM 1.40 OR EARLIER"
Caching behaviour has changed since 1.40, and this may result in pages that were
previously cached start failing to cache, and in some cases, emit warnings.
.PP
To return to the 1.40 behaviour:
.PP
.Vb 3
\&    $mech\->cache_undef_content_length(1);  # Default is 0
\&    $mech\->cache_zero_content_length(1);   # Default is 0
\&    $mech\->cache_mismatch_content_length(1); # Default is \*(Aqwarn\*(Aq
.Ve
.SH "THANKS"
.IX Header "THANKS"
Iain Truskett for writing this in the first place.
Andy Lester for graciously handing over maintainership.
Kent Fredric for adding content length handling.
.SH "SUPPORT"
.IX Header "SUPPORT"
You can find documentation for this module with the perldoc command.
.PP
.Vb 1
\&    perldoc WWW::Mechanize::Cached
.Ve
.IP "\(bu" 4
Search \s-1CPAN\s0
.Sp
<https://metacpan.org/module/WWW::Mechanize::Cached>
.SH "SEE ALSO"
.IX Header "SEE ALSO"
WWW::Mechanize, WWW::Mechanize::Cached::GZip.
.SH "AUTHORS"
.IX Header "AUTHORS"
.IP "\(bu" 4
Iain Truskett (original author)
.IP "\(bu" 4
Andy Lester <petdance@cpan.org> (2004 \- July 2009)
.IP "\(bu" 4
Olaf Alders <olaf@wundercounter.com> (current maintainer)
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
This software is copyright (c) 2004 by Iain Truskett and Andy Lester.
.PP
This is free software; you can redistribute it and/or modify it under
the same terms as the Perl 5 programming language system itself.
