.\" Automatically generated by Pod::Man 4.14 (Pod::Simple 3.40)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "Log::Shiras::Telephone 3"
.TH Log::Shiras::Telephone 3 "2016-10-03" "perl v5.32.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
Log::Shiras::Telephone \- Send messages with Log::Shiras
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 4
\&        package MyCoolPackage;
\&        use Moose;
\&        use lib \*(Aqlib\*(Aq, \*(Aq../lib\*(Aq,;
\&        use Log::Shiras::Telephone;
\&
\&        sub make_a_noise{
\&                my( $self, $message ) = @_;
\&                my $phone = Log::Shiras::Telephone\->new(
\&                                                name_space => \*(AqTellMeAbout::make_a_noise\*(Aq,
\&                                                fail_over => 1,
\&                                                report => \*(Aqspy\*(Aq,
\&                                        );
\&                $phone\->talk( level => \*(Aqdebug\*(Aq,
\&                        message => "Arrived at make_a_noise with the message: $message" );
\&                print \*(Aq!!!!!!!! \*(Aq . uc( $message  ) . " !!!!!!!!!\en";
\&                $phone\->talk( level => \*(Aqinfo\*(Aq,
\&                        message => "Finished printing message" );
\&        }
\&
\&        package main;
\&
\&        use Modern::Perl;
\&        use Log::Shiras::Switchboard;
\&        use Log::Shiras::Report::Stdout;
\&        use MyCoolPackage;
\&        $| = 1;
\&        my      $agitation = MyCoolPackage\->new;
\&                $agitation\->make_a_noise( \*(AqHello World 1\*(Aq );#
\&        my      $operator = Log::Shiras::Switchboard\->get_operator(
\&                        name_space_bounds =>{
\&                                TellMeAbout =>{
\&                                        make_a_noise =>{
\&                                                UNBLOCK =>{
\&                                                        # UNBLOCKing the report (destinations)
\&                                                        #       at the \*(AqTellMeAbout::make_a_noise\*(Aq caller name_space and deeper
\&                                                        spy     => \*(Aqinfo\*(Aq,# for info and more urgent messages
\&                                                },
\&                                        },
\&                                },
\&                        },
\&                );
\&                $agitation\->make_a_noise( \*(AqHello World 2\*(Aq );#
\&                $operator\->add_reports(
\&                        spy =>[ Print::Log\->new, ],
\&                );
\&                $agitation\->make_a_noise( \*(AqHello World 3\*(Aq );#
\&
\&        #######################################################################################
\&        # Synopsis Screen Output
\&        # 01: !!!!!!!! HELLO WORLD 1 !!!!!!!!!
\&        # 02: !!!!!!!! HELLO WORLD 2 !!!!!!!!!
\&        # 03: This message sent to the report \-spy\- was approved but found no destination objects to use at log_shiras_telephone.pl line 16, <DATA> line 1.
\&        # 04:   MyCoolPackage::make_a_noise(MyCoolPackage=HASH(0x58df970), "Hello World 2") called at log_shiras_telephone.pl line 67
\&        # 05: Finished printing message
\&        # 06: !!!!!!!! HELLO WORLD 3 !!!!!!!!!
\&        # 07: | level \- info   | name_space \- TellMeAbout::make_a_noise
\&        # 08: | line  \- 0016   | file_name  \- log_shiras_telephone.pl
\&        # 09:   :(      Finished printing message ):
\&        #######################################################################################
.Ve
.SS "\s-1SYNOPSIS EXPLANATION\s0"
.IX Subsection "SYNOPSIS EXPLANATION"
\fIOutput explanation\fR
.IX Subsection "Output explanation"
.PP
01: This is the result of
.PP
.Vb 1
\&        $agitation\->make_a_noise( \*(AqHello World 1\*(Aq );
.Ve
.PP
Where the output is processed by the make_a_noise method of the package MyCoolPackage
.PP
02: Same as line 01
.PP
03\-05: The switchboard actually turned on permissions for some logging from MyCoolPackage
prior to the output from line 02 but there was no report destination available so the
\&'fail_over' attribute kicked in and printed the message out with a warning.
.PP
06: Same as line 01
.PP
07\-09: This time before the output for line 06 was sent an actual report object was
registered in the switchboard against the 'spy' report name that MyCoolPackage was
sending logging messages to.  These lines are the result of that report object
Log::Shiras::Report::Stdout with the note that line 09: and line 05: have the same
content but ~::Report::Stdout leverages some of the meta-data in the message to create
a more informative output set.
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
This is a convenience wrapper for the method 
\&\*(L"master_talk( \f(CW$args_ref\fR )\*(R" in Log::Shiras::Switchboard.  It also provides some
additional function not provided in the leaner and stricter master_talk method.  First,
the input is more flexible allowing for several ways to compose the message.  Second,
most of the Attributes of a phone are sent as the key parts of a
message ref for to the Switchboard.  Each of these attributes has a default allowing for
them to be ommited from the phone talk method call. Third, the phone has
an additional attribute fail_over which can be used to trigger printing the
message when it is cleared by the switchboard but a report object isn't built yet.  This
will allow for development work on writing messages without having to predefine the full
output destination.  Finally, built into 'talk' is the ability to request input with the
\&'ask' key. This is done without accessing the Switchboard.  This creates a range of uses
for the 'talk' command.  It is possible to call 'talk' with no arguments and only collect
the metadata for that script point to be sent to a destination log.  Any talk command 
merges the response into the message.
.PP
Updating the default \f(CW$phone\fR attributes are done with the attribute methods
\&.
.PP
Please note the effect of calling level => 'fatal' documented in
\&\*(L"logging_levels\*(R" in Log::Shiras::Switchboard
.PP
Please also note that the switchboard will add some meta data to the message before
it passes the message on to the report.  See the documentation in
\&\*(L"master_talk( \f(CW$args_ref\fR )\*(R" in Log::Shiras::Switchboard
.PP
This module is meant to work with Log::Shiras::Switchboard at run time.  When
collecting output from the phone the switchboard must be activated to enable desired
messages to get through. For an overview of the package see Log::Shiras.
.SS "Attributes"
.IX Subsection "Attributes"
Data passed to \->new when creating an instance.  For modification of these attributes
after the instance is created see the attribute methods.
.PP
\fIname_space\fR
.IX Subsection "name_space"
.Sp
.RS 4
\&\fBDefinition:\fR This is meant to represent the 'from' designation of a Telephone call.  This
attribute stores the specific point in a hierarchical name-space used by the instance of
this class.  The name-space position called does not have to be unique.  The name-space is
identified in a string where levels of the name-space in the string are marked with '::'.
If this attribute receives an array ref then it joins the elements of the array ref with '::'.
.Sp
\&\fBDefault:\fR If no name-space is passed then this attribute defaults to the value returned
by
.Sp
.Vb 1
\&    (caller( 2 ))[3]
.Ve
.Sp
which is driven by the location where the \->new command is called.
.Sp
\&\fBRange:\fR \*(L"NameSpace\*(R" in Log::Shiras::Types
.Sp
\&\fBattribute methods\fR
.Sp
.RS 4
\&\fBset_name_space\fR
.Sp
.RS 4
\&\fBDescription\fR used to set the attribute
.RE
.RE
.RS 4
.Sp
\&\fBget_name_space\fR
.Sp
.RS 4
\&\fBDescription\fR used to return the current attribute value
.RE
.RE
.RS 4
.RE
.RE
.RS 4
.RE
.PP
\fIreport\fR
.IX Subsection "report"
.Sp
.RS 4
\&\fBDefinition:\fR This is meant to represent the 'to' nature of a Telephone call.  This
attribute stores the specific destination name in a flat name-space for this instance
of this class.
.Sp
\&\fBDefault:\fR 'log_file'
.Sp
\&\fBRange:\fR a string
.Sp
\&\fBattribute methods\fR
.Sp
.RS 4
\&\fBset_report\fR
.Sp
.RS 4
\&\fBDescription\fR used to set the attribute
.RE
.RE
.RS 4
.Sp
\&\fBget_report\fR
.Sp
.RS 4
\&\fBDescription\fR used to return the current attribute value
.RE
.RE
.RS 4
.RE
.RE
.RS 4
.RE
.PP
\fIlevel\fR
.IX Subsection "level"
.Sp
.RS 4
\&\fBDefinition:\fR This represents the urgency for which the message is sent.  A message
level of fatal will kill the script if the Switchboard permissions are set to allow
it through.
.Sp
\&\fBDefault:\fR 11 = 'eleven' or the very highest setting (urgency)
.Sp
\&\fBRange:\fR \*(L"ElevenInt\*(R" in Log::Shiras::Types or \*(L"logging_levels\*(R" in Log::Shiras::Switchboard
.Sp
\&\fBattribute methods\fR
.Sp
.RS 4
\&\fBset_level\fR
.Sp
.RS 4
\&\fBDescription\fR used to set the attribute
.RE
.RE
.RS 4
.Sp
\&\fBget_level\fR
.Sp
.RS 4
\&\fBDescription\fR used to return the current attribute value
.RE
.RE
.RS 4
.RE
.RE
.RS 4
.RE
.PP
\fImessage\fR
.IX Subsection "message"
.Sp
.RS 4
\&\fBDefinition:\fR This is a message ref that will be sent to the report.
.Sp
\&\fBDefault:\fR [ '' ]
.Sp
\&\fBRange:\fR an ArrayRef or a string (which will be used as [ \f(CW$string\fR ] )  If you wish
to send a \f(CW$hashref\fR send it as [ \f(CW$hashref\fR ].
.Sp
\&\fBattribute methods\fR
.Sp
.RS 4
\&\fBset_shared_message\fR
.Sp
.RS 4
\&\fBDescription\fR used to set the attribute
.RE
.RE
.RS 4
.Sp
\&\fBget_shared_message\fR
.Sp
.RS 4
\&\fBDescription\fR used to return the current attribute value
.RE
.RE
.RS 4
.RE
.RE
.RS 4
.RE
.PP
\fIcarp_stack\fR
.IX Subsection "carp_stack"
.Sp
.RS 4
\&\fBDefinition:\fR This is a flag used to append the message with a Carp \- longmess
.Sp
\&\fBDefault:\fR 0 = No appended longmess
.Sp
\&\fBRange:\fR 1 or 0
.Sp
\&\fBattribute methods\fR
.Sp
.RS 4
\&\fBset_carp_stack\fR
.Sp
.RS 4
\&\fBDescription\fR used to set the attribute
.RE
.RE
.RS 4
.Sp
\&\fBshould_carp_longmess\fR
.Sp
.RS 4
\&\fBDescription\fR used to return the current attribute value
.RE
.RE
.RS 4
.RE
.RE
.RS 4
.RE
.PP
\fIfail_over\fR
.IX Subsection "fail_over"
.Sp
.RS 4
\&\fBDefinition:\fR This attribute stores a boolean value that acts as a switch to turn off or
on an outlet to messages sent via \->talk that are approved based on name_space and urgency
but do not find any report objects to interact with.  If fail_over is on then the 'message'
elements are printed to \s-1STDOUT.\s0  (joined by \*(L"\en\et\*(R",) This is a helpfull
feature when writing code containing the Telephone but you don't want to set up a
report to see what is going on.  You can managage a whole script by having a
\&\f(CW$fail_over\fR variable at the top that is used to set each of the fail_over attributes for
new telephones.  That way you can turn this on or off for the whole script at once if
you want.
.Sp
\&\fBDefault:\fR 0 = off \-> unreported succesfull messages die silently
.Sp
\&\fBRange:\fR a boolean 1 or 0
.Sp
\&\fBattribute methods\fR
.Sp
.RS 4
\&\fBset_fail_over\fR
.Sp
.RS 4
\&\fBDescription\fR used to set the attribute
.RE
.RE
.RS 4
.Sp
\&\fBshould_fail_over\fR
.Sp
.RS 4
\&\fBDescription\fR used to return the current attribute value
.RE
.RE
.RS 4
.RE
.RE
.RS 4
.RE
.SS "Methods"
.IX Subsection "Methods"
\fInew( \f(CI%args\fI )\fR
.IX Subsection "new( %args )"
.Sp
.RS 4
\&\fBDefinition:\fR This creates a new instance of the Telephone class.  It is used to talk
to reports through the switchboard.
.Sp
\&\fBRange:\fR This is a Moose class and new is managed by Moose.  It
will accept any or none of the Attributes
.Sp
\&\fBReturns:\fR A phone instance that can be used to 'talk' to reports.
.RE
.PP
\fItalk( \f(CI%args\fI )\fR
.IX Subsection "talk( %args )"
.Sp
.RS 4
\&\fBDefinition:\fR This is the method to place a call to a reports name.
The talk command accepts any of the attributes as arguments as well as an 'ask' key.  The
ask key set to 1 will cause the telephone to pause for input and append that input to the
\&'message'.  Any passed key that matches an attribute will locally implement the passed value
without overwriting the default value.  The passed \f(CW%args\fR with attribute keys can either be
a Hash or a HashRef.  If the passed content does not show either a message key, an ask key,
or a level key set to fatal then it is assumed to be the message and 'talk' will re-wrap it
with a message key into a hashref.  If you want the message to be a HashRef then it has to
reside inside of an ArrayRef. ex.
.Sp
.Vb 1
\&        [ { ~ my message hash ~ } ],
.Ve
.Sp
When the message has been coerced into a format that the Switchboard will consume the {ask}
key is tested and implemented.  After the ask key processing is complete the message is
sent to \*(L"master_talk( \f(CW$args_ref\fR )\*(R" in Log::Shiras::Switchboard.  The return value from that
call is then evaluated against the attribute fail_over.  If needed the
message is output at that time.  It should be noted that the results of the 'master_talk'
can fall in the following range.
.Sp
.Vb 5
\&        \-3 = The call was not allowed by name_space permissions set in the switchboard
\&        \-2 = The message was buffered rather than sent to a report
\&        \-1 = You should never get this from a Telephone talk call
\&         0 = The call had permissions but found no report implementations to connect with
\&         1(and greater) = This indicates how many report instances received the message
.Ve
.Sp
fail_over is only implemented on a '0' return.  Read the name_space_bounds
 documentation to understand how the switchboard
handles message filtering.  \fINote: the switchboard will set the urgency level of a call to
0 if a level name is sent but it does not match the available log level list
 for the destination report held by the
Switchboard\fR.
.Sp
\&\fBReturns:\fR The number of times the message was sent to a report object with 'add_line'
.RE
.SH "GLOBAL VARIABLES"
.IX Header "GLOBAL VARIABLES"
.IP "\fB\f(CB$ENV\fB{hide_warn}\fR" 4
.IX Item "$ENV{hide_warn}"
The module will warn if debug lines are 'Uhide'n.  In the case where the you don't want
this notification set this environmental variable to true.
.SH "SUPPORT"
.IX Header "SUPPORT"
.RS 4
Log\-Shiras/issues <https://github.com/jandrew/Log-Shiras/issues>
.RE
.SH "TODO"
.IX Header "TODO"
.RS 4
\&\fB1.\fR Nothing currently
.RE
.SH "AUTHOR"
.IX Header "AUTHOR"
.IP "Jed Lund" 4
.IX Item "Jed Lund"
.PD 0
.IP "jandrew@cpan.org" 4
.IX Item "jandrew@cpan.org"
.PD
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
This program is free software; you can redistribute
it and/or modify it under the same terms as Perl itself.
.PP
The full text of the license can be found in the
\&\s-1LICENSE\s0 file included with this module.
.SH "DEPENDENCIES"
.IX Header "DEPENDENCIES"
.RS 4
perl 5.010
.Sp
version
.Sp
Moose
.Sp
MooseX::StrictConstructor
.Sp
MooseX::HasDefaults::RO
.Sp
MooseX::Types::Moose
.RE
